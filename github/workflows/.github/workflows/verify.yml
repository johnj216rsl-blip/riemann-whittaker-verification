name: Verify Whittaker condition

on: [push, pull_request]

jobs:
  verify:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      - run: pip install mpmath==1.3.0
      - run: python -c "
from mpmath import mp, zetazero, besselk, sqrt, pi; mp.dps=100
max_res = max(abs(sqrt(2*pi*n/pi)*besselk(mp.mpc(0,mp.im(zetazero(n))), pi*n)) for n in range(1,1001))
assert float(max_res) < 1e-35, f'Failed: {max_res}'
print('Verification passed â€“ max residual:', max_res)"
